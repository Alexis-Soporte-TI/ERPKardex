PRINT 'Iniciando Migracion Masiva Completa...'

-- =============================================
-- 1. CARGA DE METADATA (GRUPOS, SUBGRUPOS, MARCAS)
-- =============================================
-- GRUPOS
IF NOT EXISTS (SELECT * FROM grupo WHERE codigo = '2102') INSERT INTO grupo (codigo, descripcion, cuenta_id) VALUES ('2102', 'PRODUCTO TERMINADO', '21');
IF NOT EXISTS (SELECT * FROM grupo WHERE codigo = '2404') INSERT INTO grupo (codigo, descripcion, cuenta_id) VALUES ('2404', 'ENVASES Y EMBALAJES', '24');
IF NOT EXISTS (SELECT * FROM grupo WHERE codigo = '2405') INSERT INTO grupo (codigo, descripcion, cuenta_id) VALUES ('2405', 'SUMINISTROS DIVERSOS', '24');
IF NOT EXISTS (SELECT * FROM grupo WHERE codigo = '3306') INSERT INTO grupo (codigo, descripcion, cuenta_id) VALUES ('3306', 'ACTIVOS', '33');
IF NOT EXISTS (SELECT * FROM grupo WHERE codigo = '2101') INSERT INTO grupo (codigo, descripcion, cuenta_id) VALUES ('2101', 'MERCADERÍA', '21');

-- SUBGRUPOS (Generados dinámicamente)
DECLARE @Subgrupos TABLE (cod_full VARCHAR(50), cod_g VARCHAR(50), descr VARCHAR(255));
INSERT INTO @Subgrupos VALUES 
('2102001', '2102', 'HERBICIDAS'), ('2102008', '2102', 'BIOINSUMOS'), ('2102009', '2102', 'COADYUVANTES FORMULADOS'), 
('2102010', '2102', 'FERTILIZANTES FORMULADOS'), ('2404001', '2404', 'ENVASES PRIMARIOS PLÁSTICOS'), 
('2404004', '2404', 'TAPAS Y DOSIFICADORES'), ('2404005', '2404', 'ETIQUETAS'), ('2404007', '2404', 'BOLSAS Y SACOS'), 
('2404009', '2404', 'PALLETS'), ('2404011', '2404', 'OTROS ENVASES Y EMBALAJES'), ('2405001', '2405', 'MATERIALES DE LABORATORIO'), 
('2405003', '2405', 'MATERIALES DE MANTENIMIENTO'), ('2405006', '2405', 'EPP'), ('2405007', '2405', 'LIMPIEZA'), 
('2405008', '2405', 'LUBRICANTES Y ACEITES'), ('2405010', '2405', 'ÚTILES DE OFICINA'), ('2405005', '2405', 'HERRAMIENTAS'), 
('2405011', '2405', 'OTROS SUMINISTROS'), ('3306001', '3306', 'MAQUINARIA DE PRODUCCIÓN'), ('3306002', '3306', 'EQUIPOS DE LABORATORIO'), 
('3306005', '3306', 'MUEBLES Y ENSERES'), ('2101002', '2101', 'FERTILIZANTES'), ('2101004', '2101', 'COADYUVANTES'), 
('2101003', '2101', 'BIOESTIMULANTES'), ('2101001', '2101', 'AGROQUÍMICOS');

INSERT INTO subgrupo (codigo, descripcion, grupo_id, cod_grupo, descripcion_grupo)
SELECT s.cod_full, s.descr, g.id, g.codigo, g.descripcion
FROM @Subgrupos s JOIN grupo g ON g.codigo = s.cod_g
WHERE NOT EXISTS (SELECT 1 FROM subgrupo WHERE codigo = s.cod_full);

-- INGREDIENTES ACTIVOS FALTANTES
DECLARE @Ingredientes TABLE (nom VARCHAR(255));
INSERT INTO @Ingredientes VALUES 
('Glyfosato'), ('Citoquininas, Giberelinas y Auxinas'), ('Extracto Citrico'), ('Ácido Glutamico'), 
('Ácido Glutamico Brasinosteroide'), ('Gluconato de Sodio'), ('Trisiloxano Etoxilado'), ('OXIDO DE CALCIO'), 
('Hierro Quelatado'), ('Ácidos Fumicos Ácidos Humicos'), ('ÓXIDO DE MAGNESIO'), ('ZINC'), ('COBRE'), 
('POTASIO'), ('EDTA'), ('GLUTAMATO'), ('CARBOHIDRATOS'), ('LEVADURA'), ('SODIO'), ('CALCIO'), ('UREA');

INSERT INTO ingrediente_activo (descripcion)
SELECT nom FROM @Ingredientes WHERE NOT EXISTS (SELECT 1 FROM ingrediente_activo WHERE descripcion = nom);

-- OTROS MAESTROS
IF NOT EXISTS (SELECT * FROM formulacion_quimica WHERE codigo = 'SL') INSERT INTO formulacion_quimica VALUES ('SL', 'SL', 'SL', '');
IF NOT EXISTS (SELECT * FROM formulacion_quimica WHERE codigo = 'SP') INSERT INTO formulacion_quimica VALUES ('SP', 'SP', 'SP', '');

-- =============================================
-- 2. CARGA MASIVA DE PRODUCTOS (TABLA TEMPORAL)
-- =============================================
IF OBJECT_ID('tempdb..#TempLoad') IS NOT NULL DROP TABLE #TempLoad;
CREATE TABLE #TempLoad (
    p_code VARCHAR(50), g_code VARCHAR(50), s_code VARCHAR(50), desc_prod VARCHAR(255), desc_com VARCHAR(255),
    conc DECIMAL(12,2), form VARCHAR(50), lote VARCHAR(50), f_fab DATE, f_ven DATE, peligro VARCHAR(50),
    um VARCHAR(50), marca VARCHAR(255), modelo VARCHAR(255), serie VARCHAR(255), activo BIT, qty DECIMAL(12,2), ingrediente VARCHAR(255)
);

-- CARGA DE 249 PRODUCTOS (Optimizada para SQL Server)
INSERT INTO #TempLoad VALUES
('2101001001', '2101', '2101001', '24 EPIBRASINOLIDE - FUNGICIDA', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'KGM', NULL, NULL, NULL, 0, 0.295, NULL),
('2101001002', '2101', '2101001', 'SULFATO DE COBRE PENTAHIDRATADO', NULL, 98.2, NULL, 'GOSS', '2025-09-20', '2027-09-20', 'OMS-III', 'KGM', NULL, NULL, NULL, 0, 1225.0, 'COBRE'),
('2101001003', '2101', '2101001', 'SULFATO DE COBRE PENTAHIDRATADO', NULL, 98.2, NULL, '5991', NULL, NULL, 'OMS-III', 'KGM', NULL, NULL, NULL, 0, 800.0, 'COBRE'),
('2101001004', '2101', '2101001', 'SULFATO DE COBRE PENTAHIDRATADO', NULL, NULL, NULL, '5918', NULL, NULL, 'OMS-III', 'KGM', NULL, NULL, NULL, 0, 62.0, 'COBRE'),
('2101001005', '2101', '2101001', 'SULFATO DE COBRE PENTAHIDRATADO', NULL, NULL, NULL, '5874', NULL, NULL, 'OMS-III', 'KGM', NULL, NULL, NULL, 0, 75.0, 'COBRE'),
('2101001006', '2101', '2101001', 'SULFATO DE COBRE PENTAHIDRATADO', NULL, NULL, NULL, '5968', NULL, NULL, 'OMS-III', 'KGM', NULL, NULL, NULL, 0, 50.0, 'COBRE'),
('2101002001', '2101', '2101002', 'BICARBONATO DE POTASIO', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'KGM', NULL, NULL, NULL, 0, 4.0, NULL),
('2101002002', '2101', '2101002', 'FERTIBAGRA', NULL, 99.2, NULL, 'NK-049', NULL, NULL, 'OMS-IA', 'KGM', NULL, NULL, NULL, 0, 100.0, NULL),
('2101002003', '2101', '2101002', 'GLUTAMATO DE SODIO', NULL, NULL, NULL, '20250525', NULL, NULL, NULL, 'KGM', NULL, NULL, NULL, 0, 30.0, 'SODIO'),
('2101002004', '2101', '2101002', 'GLUTAMATO DE SODIO', NULL, NULL, NULL, '20250630', NULL, NULL, NULL, 'KGM', NULL, NULL, NULL, 0, 400.0, 'SODIO'),
('2101002005', '2101', '2101002', 'MOLIBDATO DE SODIO', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'KGM', NULL, NULL, NULL, 0, 5.71, NULL),
('2101002006', '2101', '2101002', 'NITRATO DE CALCIO', NULL, 23, NULL, '0501DJ241504', NULL, NULL, NULL, 'KGM', NULL, NULL, NULL, 0, 100.0, 'CALCIO'),
('2101002007', '2101', '2101002', 'NITRATO DE ZINC', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'KGM', NULL, NULL, NULL, 0, 12.2, 'ZINC'),
('2101002008', '2101', '2101002', 'SULFATO DE MAGNESIO', NULL, 90, NULL, '20201', NULL, NULL, NULL, 'KGM', NULL, NULL, NULL, 0, 23.28, 'ÓXIDO DE MAGNESIO'),
('2101002009', '2101', '2101002', 'SULFATO DE ZINC', NULL, 99.9, NULL, '14024', NULL, NULL, 'OMS-III', 'KGM', NULL, NULL, NULL, 0, 1015.4, 'ZINC'),
('2101002010', '2101', '2101002', 'UREA', NULL, 46, NULL, '62009', NULL, NULL, 'OMS-III', 'KGM', NULL, NULL, NULL, 0, 19.0, 'UREA'),
('2101003001', '2101', '2101003', '24-ESI-BRASSINOLIDE', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'KGM', NULL, NULL, NULL, 0, 0.78, NULL),
('2101003002', '2101', '2101003', 'AMINOÁCIDOS', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'KGM', NULL, NULL, NULL, 0, 53.0, NULL),
('2101003003', '2101', '2101003', 'BENCILAMINOPURINA', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'KGM', NULL, NULL, NULL, 0, 15.31, NULL),
('2101003004', '2101', '2101003', 'EXTRACTO DE ALGAS', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'KGM', NULL, NULL, NULL, 0, 88.67, NULL),
('2101003005', '2101', '2101003', 'GLICINA-BETAINA', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'KGM', NULL, NULL, NULL, 0, 54.9, NULL),
('2101003006', '2101', '2101003', 'INOSITOL', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'KGM', NULL, NULL, NULL, 0, 28.0, NULL),
('2101003007', '2101', '2101003', 'KINETINA', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'KGM', NULL, NULL, NULL, 0, 12.5, NULL),
('2101003008', '2101', '2101003', 'LEVADURA', NULL, NULL, NULL, '4205B20256', NULL, NULL, NULL, 'KGM', NULL, NULL, NULL, 0, 619.0, 'LEVADURA'),
('2101003009', '2101', '2101003', 'VITAMINA B2', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'KGM', NULL, NULL, NULL, 0, 22.0, NULL),
('2101003010', '2101', '2101003', 'ÁCIDO GIBERÉLICO', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'KGM', NULL, NULL, NULL, 0, 16.04, NULL),
('2101003011', '2101', '2101003', 'ÁCIDO GLUTÁMICO', NULL, NULL, NULL, '240515', NULL, NULL, NULL, 'KGM', NULL, NULL, NULL, 0, 2245.0, 'GLUTAMATO'),
('2101003012', '2101', '2101003', 'ÁCIDO INDOL BUTÍRICO', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'KGM', NULL, NULL, NULL, 0, 18.18, NULL),
('2101003013', '2101', '2101003', 'ÁCIDO NAFTALENACÉTICO', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'KGM', NULL, NULL, NULL, 0, 6.07, NULL),
('2101003014', '2101', '2101003', 'ÁCIDO SALICÍLICO', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'KGM', NULL, NULL, NULL, 0, 0.3, NULL),
('2101004001', '2101', '2101004', 'ACTICIDE SPY', NULL, NULL, NULL, 'B71441882610', NULL, NULL, 'OMS-IB', 'KGM', NULL, NULL, NULL, 0, 49.61, NULL),
('2101004002', '2101', '2101004', 'ACTISIDE AFMSAKONSP', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'KGM', NULL, NULL, NULL, 0, 27.0, NULL),
('2101004003', '2101', '2101004', 'EDTA 4NA', NULL, 99.9, NULL, '20250805', NULL, NULL, 'OMS-IB', 'KGM', NULL, NULL, NULL, 0, 1085.84, 'EDTA'),
('2101004004', '2101', '2101004', 'GOMA XANTHAN', NULL, NULL, NULL, '202504000000', NULL, NULL, NULL, 'KGM', NULL, NULL, NULL, 0, 25.16, NULL),
('2101004005', '2101', '2101004', 'HIDRÓXIDO DE POTASIO', NULL, 90, NULL, '90250702', NULL, NULL, 'OMS-IB', 'KGM', NULL, NULL, NULL, 0, 225.0, 'POTASIO'),
('2101004006', '2101', '2101004', 'HIDRÓXIDO DE POTASIO', NULL, NULL, NULL, '24/209', NULL, NULL, 'OMS-IB', 'KGM', NULL, NULL, NULL, 0, 112.7, 'POTASIO'),
('2101004007', '2101', '2101004', 'KHATON', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'KGM', NULL, NULL, NULL, 0, 7.5, NULL),
('2101004008', '2101', '2101004', 'LIGNOSULFATO DE SODIO', NULL, NULL, NULL, '1242660', NULL, NULL, NULL, 'KGM', NULL, NULL, NULL, 0, 182.92, NULL),
('2101004009', '2101', '2101004', 'SILOXANO', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'KGM', NULL, NULL, NULL, 0, 74.0, NULL),
('2101004010', '2101', '2101004', 'ÁCIDO ACÉTICO', NULL, NULL, NULL, 'C5C24080601', NULL, NULL, 'OMS-IB', 'KGM', NULL, NULL, NULL, 0, 275.0, NULL),
('2101004011', '2101', '2101004', 'ÁCIDO CÍTRICO', NULL, NULL, NULL, 'A506038', NULL, NULL, 'OMS-IB', 'KGM', NULL, NULL, NULL, 0, 61.5, NULL),
('2101004012', '2101', '2101004', 'ÁCIDO FOSFÓRICO', NULL, NULL, NULL, '20250626', NULL, NULL, NULL, 'KGM', NULL, NULL, NULL, 0, 52.37, NULL),
('2101004013', '2101', '2101004', 'ÁCIDO LÁCTICO', NULL, 85, NULL, '2024092025', NULL, NULL, 'OMS-IB', 'KGM', NULL, NULL, NULL, 0, 508.0, 'CARBOHIDRATOS'),
('2101004014', '2101', '2101004', 'ÁCIDO PROPIÓNICO', NULL, NULL, NULL, '3703W712414509L', NULL, NULL, 'OMS-IB', 'KGM', NULL, NULL, NULL, 0, 323.0, NULL),
('2102001001', '2102', '2102001', 'GLIFOWITE', 'GLIFOWITE 48 % SL - 4 LTR', 48, 'SL', '24RFA2569', '2024-06-05', '2026-06-05', 'OMS-III', 'NIU', NULL, NULL, NULL, 0, 7.0, 'Glyfosato'),
('2102001002', '2102', '2102001', 'GLIFOWITE', 'GLIFOWITE 48 % SL - 1 LTR', 48, 'SL', '24RFA2569', '2024-06-05', '2026-06-05', 'OMS-III', 'NIU', NULL, NULL, NULL, 0, 138.0, 'Glyfosato'),
('2102008001', '2102', '2102008', 'FITOBRASS', 'FITOBRASS 4.3 % SL - 20 LTR', 4.3, 'SL', 'AQX200925', '2025-09-20', '2027-09-20', 'OMS-U', 'NIU', NULL, NULL, NULL, 0, 2.0, 'Citoquininas, Giberelinas y Auxinas'),
('2102008002', '2102', '2102008', 'KNOCK OUT', 'KNOCK OUT 2 % SL - 4 LTR', 2, 'SL', '25011302', '2025-01-30', '2028-01-30', 'OMS-U', 'NIU', NULL, NULL, NULL, 0, 23.0, 'Extracto Citrico'),
('2102008003', '2102', '2102008', 'VITAGLU', 'VITAGLU 45 % SL - 20 LTR', 45, 'SL', 'AQX280325', '2025-03-28', '2027-03-28', 'OMS-U', 'NIU', NULL, NULL, NULL, 0, 9.0, 'Ácido Glutamico'),
('2102008004', '2102', '2102008', 'VITAGLU', 'VITAGLU 45 % SL - 200 LTR', 45, 'SL', 'AQX280325', '2025-03-28', '2027-03-28', 'OMS-U', 'NIU', NULL, NULL, NULL, 0, 12.0, 'Ácido Glutamico'),
('2102008005', '2102', '2102008', 'VITAGLU PLUS', 'VITAGLU PLUS 45 % SL - 4 LTR', 45, 'SL', 'AQX020425', '2025-04-02', '2027-04-02', 'OMS-U', 'NIU', NULL, NULL, NULL, 0, 1.0, 'Ácido Glutamico Brasinosteroide'),
('2102008006', '2102', '2102008', 'VITAGLU PLUS', 'VITAGLU PLUS 45 % SL - 200 LTR', 45, 'SL', 'AQX020425', '2025-04-02', '2027-04-02', 'OMS-U', 'NIU', NULL, NULL, NULL, 0, 11.0, 'Ácido Glutamico Brasinosteroide'),
('2102008007', '2102', '2102008', 'VITAGLU PLUS', 'VITAGLU PLUS 45 % SL - 20 LTR', 45, 'SL', 'AQX020425', '2025-04-02', '2027-04-02', 'OMS-U', 'NIU', NULL, NULL, NULL, 0, 18.0, 'Ácido Glutamico Brasinosteroide'),
('2102009001', '2102', '2102009', 'GLUXFORT', 'GLUXFORT 28 % SL - 20 LTR', 28, 'SL', 'AQX120525', '2025-05-12', '2027-05-12', 'OMS-U', 'NIU', NULL, NULL, NULL, 0, 3.0, 'Gluconato de Sodio'),
('2102009002', '2102', '2102009', 'GLUXFORT', 'GLUXFORT 28 % SL - 4 LTR', 28, 'SL', 'AQX120525', '2025-05-12', '2027-05-12', 'OMS-U', 'NIU', NULL, NULL, NULL, 0, 6.0, 'Gluconato de Sodio'),
('2102009003', '2102', '2102009', 'THEOXOCOL', 'THEOXOCOL 100 % SL - 20 LTR', 100, 'SL', 'SC25329', '2025-07-01', '2027-06-01', 'OMS-U', 'NIU', NULL, NULL, NULL, 0, 48.0, 'Trisiloxano Etoxilado'),
('2102010001', '2102', '2102010', 'CALCIO', 'CALCIO 9 % SL - 4 LTR', 9, 'SL', 'AQX280125', '2025-01-28', '2027-01-28', 'OMS-U', 'NIU', NULL, NULL, NULL, 0, 2.0, 'OXIDO DE CALCIO'),
('2102010002', '2102', '2102010', 'IRONQUEL', 'IRONQUEL 8.8 % SP - 25 KGM', 8.8, 'SP', 'SC3671', '2025-03-01', '2027-03-01', 'OMS-U', 'NIU', NULL, NULL, NULL, 0, 20.0, 'Hierro Quelatado'),
('2102010003', '2102', '2102010', 'LEONARDITA 56 % SL - 1000 LTR', 'LEONARDITA 56 % SL - 1000 LTR', 56, 'SL', 'TBD1000200925', '2025-09-20', '2027-09-20', 'OMS-U', 'NIU', NULL, NULL, NULL, 0, 9.0, 'Ácidos Fumicos Ácidos Humicos'),
('2102010004', '2102', '2102010', 'LEONARDITA 56 % SL - 20 LTR', 'LEONARDITA 56 % SL - 20 LTR', 56, 'SL', 'TBD1000200925', '2025-09-20', '2027-09-20', 'OMS-U', 'NIU', NULL, NULL, NULL, 0, 50.0, 'Ácidos Fumicos Ácidos Humicos'),
('2102010005', '2102', '2102010', 'LEONARDITA 56 % SP - 25 KG', 'LEONARDITA 56 % SL - 25 KG', 56, 'SP', 'TBDG2515092025', '2025-09-20', '2027-09-20', 'OMS-U', 'NIU', NULL, NULL, NULL, 0, 1499.0, 'Ácidos Fumicos Ácidos Humicos'),
('2404001001', '2404', '2404001', 'BALDE 10 L TRANSPARENTE', 'BALDE 10 L TRANSPARENTE', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 4.0, NULL),
('2404001002', '2404', '2404001', 'BALDE 20 L TRANSPARENTE', 'BALDE 20 L TRANSPARENTE', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 51.0, NULL),
('2404001003', '2404', '2404001', 'BALDE 3.5 L TRANSPARENTE', 'BALDE 3.5 L TRANSPARENTE', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 6.0, NULL),
('2404001004', '2404', '2404001', 'BALDE 4 L BLANCO', 'BALDE 4 L BLANCO', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 2.0, NULL),
('2404001005', '2404', '2404001', 'BALDE 4 L ROJO', 'BALDE 4 L ROJO', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 1.0, NULL),
('2404001006', '2404', '2404001', 'BALDE 4 L TRANSPARENTE', 'BALDE 4 L TRANSPARENTE', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 8.0, NULL),
('2404001007', '2404', '2404001', 'BATEA AZUL 50 L', 'BATEA AZUL 50 L', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 1.0, NULL),
('2404001008', '2404', '2404001', 'BATEA COLOR 70 L', 'BATEA COLOR 70 L', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 1.0, NULL),
('2404001009', '2404', '2404001', 'BATEA ROJA 100 L', 'BATEA ROJA 100 L', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 6.0, NULL),
('2404001010', '2404', '2404001', 'BATEA ROJA 50 L', 'BATEA ROJA 50 L', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 1.0, NULL),
('2404001011', '2404', '2404001', 'BATEA ROJA 80 L', 'BATEA ROJA 80 L', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 2.0, NULL),
('2404001012', '2404', '2404001', 'BATEA VERDE 50 L', 'BATEA VERDE 50 L', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 1.0, NULL),
('2404001013', '2404', '2404001', 'BOTELLA PLÁSTICA 1 LITRO', 'BOTELLA PLÁSTICA 1 LITRO', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 531.0, NULL),
('2404001014', '2404', '2404001', 'BOTELLA PLÁSTICA 250 ML', 'BOTELLA PLÁSTICA 250 ML', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 66.0, NULL),
('2404001015', '2404', '2404001', 'BOTELLA PLÁSTICA 500 ML', 'BOTELLA PLÁSTICA 500 ML', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 73.0, NULL),
('2404001016', '2404', '2404001', 'CILINDRO PLÁSTICO 200 LITROS', 'CILINDRO PLÁSTICO 200 LITROS', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 108.0, NULL),
('2404001017', '2404', '2404001', 'COLADOR REDONDO', 'COLADOR REDONDO', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 3.0, NULL),
('2404001018', '2404', '2404001', 'COLADOR REDONDO HONDO', 'COLADOR REDONDO HONDO', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 2.0, NULL),
('2404001019', '2404', '2404001', 'COLADOR REDONDO PEQUEÑO', 'COLADOR REDONDO PEQUEÑO', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 4.0, NULL),
('2404001020', '2404', '2404001', 'EMBUDOS GRANDES', 'EMBUDOS GRANDES', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 7.0, NULL),
('2404001021', '2404', '2404001', 'FRASCO PET LISO 250 ML PACK X 207', 'FRASCO PET LISO 250 ML PACK X 207', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 19.0, NULL),
('2404001022', '2404', '2404001', 'FRASCO PET LISO 500 ML PACK X 105', 'FRASCO PET LISO 500 ML PACK X 105', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 39.0, NULL),
('2404001023', '2404', '2404001', 'GALÓN PLÁSTICO 20 LITROS', 'GALÓN PLÁSTICO 20 LITROS', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 454.0, NULL),
('2404001024', '2404', '2404001', 'GALÓN PLÁSTICO 4 LITROS', 'GALÓN PLÁSTICO 4 LITROS', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 72.0, NULL),
('2404001025', '2404', '2404001', 'JARRA 1 L', 'JARRA 1 L', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 4.0, NULL),
('2404001026', '2404', '2404001', 'JARRA 250 ML', 'JARRA 250 ML', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 5.0, NULL),
('2404001027', '2404', '2404001', 'JARRA 500 ML', 'JARRA 500 ML', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 3.0, NULL),
('2404001028', '2404', '2404001', 'JARRA TROPICAL 1 L', 'JARRA TROPICAL 1 L', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 3.0, NULL),
('2404001029', '2404', '2404001', 'SUPER TINA TUMI', 'SUPER TINA TUMI', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'TUMI', '120 mm', NULL, 0, 6.0, NULL),
('2404001030', '2404', '2404001', 'TANQUE 100 L', 'TANQUE 100 L', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 2.0, NULL),
('2404001031', '2404', '2404001', 'TANQUE 200 L', 'TANQUE 200 L', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 2.0, NULL),
('2404001032', '2404', '2404001', 'TANQUE 220 L', 'TANQUE 220 L', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 24.0, NULL),
('2404001033', '2404', '2404001', 'TANQUE ROTOPLAST 250 L', 'TANQUE ROTOPLAST 250 L', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'ROTOPLAST', '250 L', NULL, 0, 1.0, NULL),
('2404001034', '2404', '2404001', 'TANQUE ROTOPLAST 800 L', 'TANQUE ROTOPLAST 800 L', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'ROTOPLAST', '800 L', NULL, 0, 1.0, NULL),
('2404004001', '2404', '2404004', 'TAPA 200 L', 'TAPA 200 L', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 2.0, NULL),
('2404004002', '2404', '2404004', 'TAPA BALDE 10 L', 'TAPA BALDE 10 L', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 4.0, NULL),
('2404004003', '2404', '2404004', 'TAPA BALDE 20 L', 'TAPA BALDE 20 L', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 41.0, NULL),
('2404004004', '2404', '2404004', 'TAPA BALDE 220 L', 'TAPA BALDE 220 L', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 20.0, NULL),
('2404004005', '2404', '2404004', 'TAPA BALDE 3.5 L', 'TAPA BALDE 3.5 L', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 4.0, NULL),
('2404004006', '2404', '2404004', 'TAPA BALDE 4 L', 'TAPA BALDE 4 L', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 5.0, NULL),
('2404004007', '2404', '2404004', 'TAPA BALDE 4 L BLANCO', 'TAPA BALDE 4 L BLANCO', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 9.0, NULL),
('2404004008', '2404', '2404004', 'TAPA BALDE 6 L', 'TAPA BALDE 6 L', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 1.0, NULL),
('2404004009', '2404', '2404004', 'TAPA TAPER 0.75 L', 'TAPA TAPER 0.75 L', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 1.0, NULL),
('2404004010', '2404', '2404004', 'TAPER 0.75 L', 'TAPER 0.75 L', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 1.0, NULL),
('2404004011', '2404', '2404004', 'TAPER 1 L', 'TAPER 1 L', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 3.0, NULL),
('2404004012', '2404', '2404004', 'TAPER 2 L', 'TAPER 2 L', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 1.0, NULL),
('2404005001', '2404', '2404005', 'ETIQUETA AUTOADHESIVA CILINDRO 200 L FITOBRASS', 'ETIQUETA AUTOADHESIVA CILINDRO 200 L FITOBRASS', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 476.0, NULL),
('2404005002', '2404', '2404005', 'ETIQUETA AUTOADHESIVA CILINDRO 200 L GLUXFORT', 'ETIQUETA AUTOADHESIVA CILINDRO 200 L GLUXFORT', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 287.0, NULL),
('2404005003', '2404', '2404005', 'ETIQUETA AUTOADHESIVA CILINDRO 200 L THEOXOCOL', 'ETIQUETA AUTOADHESIVA CILINDRO 200 L THEOXOCOL', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 60.0, NULL),
('2404005004', '2404', '2404005', 'ETIQUETA AUTOADHESIVA CILINDRO 200 L THYME GUARD', 'ETIQUETA AUTOADHESIVA CILINDRO 200 L THYME GUARD', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 164.0, NULL),
('2404005005', '2404', '2404005', 'ETIQUETA AUTOADHESIVA ENVASE 1 L FITOBRASS', 'ETIQUETA AUTOADHESIVA ENVASE 1 L FITOBRASS', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 50.0, NULL),
('2404005006', '2404', '2404005', 'ETIQUETA AUTOADHESIVA ENVASE 1 L GLUXFORT', 'ETIQUETA AUTOADHESIVA ENVASE 1 L GLUXFORT', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 108.0, NULL),
('2404005007', '2404', '2404005', 'ETIQUETA AUTOADHESIVA ENVASE 1 L INDUCTORE', 'ETIQUETA AUTOADHESIVA ENVASE 1 L INDUCTORE', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 65.0, NULL),
('2404005008', '2404', '2404005', 'ETIQUETA AUTOADHESIVA ENVASE 1 L SULFCOBEX', 'ETIQUETA AUTOADHESIVA ENVASE 1 L SULFCOBEX', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 175.0, NULL),
('2404005009', '2404', '2404005', 'ETIQUETA AUTOADHESIVA ENVASE 1 L THYME GUARD', 'ETIQUETA AUTOADHESIVA ENVASE 1 L THYME GUARD', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 69.0, NULL),
('2404005010', '2404', '2404005', 'ETIQUETA AUTOADHESIVA ENVASE 1 L TRUSTROOT', 'ETIQUETA AUTOADHESIVA ENVASE 1 L TRUSTROOT', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 39.0, NULL),
('2404005011', '2404', '2404005', 'ETIQUETA AUTOADHESIVA ENVASE 1 L VITAGLU', 'ETIQUETA AUTOADHESIVA ENVASE 1 L VITAGLU', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 14.0, NULL),
('2404005012', '2404', '2404005', 'ETIQUETA AUTOADHESIVA ENVASE 1040 L THYME GUARD', 'ETIQUETA AUTOADHESIVA ENVASE 1040 L THYME GUARD', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 43.0, NULL),
('2404005013', '2404', '2404005', 'ETIQUETA AUTOADHESIVA ENVASE 20 L FITOBRASS', 'ETIQUETA AUTOADHESIVA ENVASE 20 L FITOBRASS', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 90.0, NULL),
('2404005014', '2404', '2404005', 'ETIQUETA AUTOADHESIVA ENVASE 20 L GLUXFORT', 'ETIQUETA AUTOADHESIVA ENVASE 20 L GLUXFORT', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 117.0, NULL),
('2404005015', '2404', '2404005', 'ETIQUETA AUTOADHESIVA ENVASE 20 L INDUCTORE', 'ETIQUETA AUTOADHESIVA ENVASE 20 L INDUCTORE', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 98.0, NULL),
('2404005016', '2404', '2404005', 'ETIQUETA AUTOADHESIVA ENVASE 20 L SULFCOBEX', 'ETIQUETA AUTOADHESIVA ENVASE 20 L SULFCOBEX', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 100.0, NULL),
('2404005017', '2404', '2404005', 'ETIQUETA AUTOADHESIVA ENVASE 20 L THEOXOCOL', 'ETIQUETA AUTOADHESIVA ENVASE 20 L THEOXOCOL', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 313.0, NULL),
('2404005018', '2404', '2404005', 'ETIQUETA AUTOADHESIVA ENVASE 20 L THYME GUARD', 'ETIQUETA AUTOADHESIVA ENVASE 20 L THYME GUARD', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 51.0, NULL),
('2404005019', '2404', '2404005', 'ETIQUETA AUTOADHESIVA ENVASE 20 L TRUSTROOT', 'ETIQUETA AUTOADHESIVA ENVASE 20 L TRUSTROOT', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 135.0, NULL),
('2404005020', '2404', '2404005', 'ETIQUETA AUTOADHESIVA ENVASE 20 L VITAGLU', 'ETIQUETA AUTOADHESIVA ENVASE 20 L VITAGLU', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 99.0, NULL),
('2404005021', '2404', '2404005', 'ETIQUETA AUTOADHESIVA ENVASE 25 K IRONQUEL', 'ETIQUETA AUTOADHESIVA ENVASE 25 K IRONQUEL', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 130.0, NULL),
('2404005022', '2404', '2404005', 'ETIQUETA AUTOADHESIVA ENVASE 25 K LEVANPLUS', 'ETIQUETA AUTOADHESIVA ENVASE 25 K LEVANPLUS', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 169.0, NULL),
('2404005023', '2404', '2404005', 'ETIQUETA AUTOADHESIVA ENVASE 4 L FITOBRASS', 'ETIQUETA AUTOADHESIVA ENVASE 4 L FITOBRASS', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 88.0, NULL),
('2404005024', '2404', '2404005', 'ETIQUETA AUTOADHESIVA ENVASE 4 L GLUXFORT', 'ETIQUETA AUTOADHESIVA ENVASE 4 L GLUXFORT', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 61.0, NULL),
('2404005025', '2404', '2404005', 'ETIQUETA AUTOADHESIVA ENVASE 4 L INDUCTORE', 'ETIQUETA AUTOADHESIVA ENVASE 4 L INDUCTORE', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 50.0, NULL),
('2404005026', '2404', '2404005', 'ETIQUETA AUTOADHESIVA ENVASE 4 L SULFCOBEX', 'ETIQUETA AUTOADHESIVA ENVASE 4 L SULFCOBEX', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 60.0, NULL),
('2404005027', '2404', '2404005', 'ETIQUETA AUTOADHESIVA ENVASE 4 L TRUSTROOT', 'ETIQUETA AUTOADHESIVA ENVASE 4 L TRUSTROOT', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 60.0, NULL),
('2404005028', '2404', '2404005', 'ETIQUETA AUTOADHESIVA ENVASE 4 L VITAGLU', 'ETIQUETA AUTOADHESIVA ENVASE 4 L VITAGLU', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 54.0, NULL),
('2404005029', '2404', '2404005', 'ETIQUETA REVERSO INFORMATIVA THYME GUARD', 'ETIQUETA REVERSO INFORMATIVA THYME GUARD', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 131.0, NULL),
('2404007001', '2404', '2404007', 'BOLSA TRANSPARENTE 1 KG', 'BOLSA TRANSPARENTE 1 KG', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 100.0, NULL),
('2404007002', '2404', '2404007', 'BOLSA TRANSPARENTE 25 KG', 'BOLSA TRANSPARENTE 25 KG', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 300.0, NULL),
('2404007003', '2404', '2404007', 'SACOS LEVAPLUS 25 KG', 'SACOS LEVAPLUS 25 KG', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 956.0, NULL),
('2404009001', '2404', '2404009', 'PARIHUELA PLÁSTICA NEGRA', 'PARIHUELA PLÁSTICA NEGRA', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, '1.3x1.1 m', NULL, 0, 20.0, NULL),
('2404011001', '2404', '2404011', 'SELLO DE SEGURIDAD', 'SELLO DE SEGURIDAD', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 20.0, NULL),
('2405001001', '2405', '2405001', 'ANCLAS DE METAL QUIRURGICO', 'ANCLAS DE METAL QUIRURGICO', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 2.0, NULL),
('2405001002', '2405', '2405001', 'BARILLA DE VIDRIO', 'BARILLA DE VIDRIO', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 3.0, NULL),
('2405001003', '2405', '2405001', 'BARRA AGITACIÓN 30X6 MM', 'BARRA AGITACIÓN 30X6 MM', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'ISOLAB', '30x6', NULL, 0, 1.0, NULL),
('2405001004', '2405', '2405001', 'BARRA AGITACIÓN 40X8 MM', 'BARRA AGITACIÓN 40X8 MM', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'ISOLAB', '40x8', NULL, 0, 1.0, NULL),
('2405001005', '2405', '2405001', 'BARRA DE AGITACION MAGNETICA', 'BARRA DE AGITACION MAGNETICA', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'ISOLAB', NULL, NULL, 0, 1.0, NULL),
('2405001006', '2405', '2405001', 'EMBUDO VIDRIO BORO', 'EMBUDO VIDRIO BORO', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'ISOLAB', '3.3x100 mm', NULL, 0, 1.0, NULL),
('2405001007', '2405', '2405001', 'FIOLA DE 100 ML', 'FIOLA DE 100 ML', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'EUROLAB', NULL, NULL, 0, 2.0, NULL),
('2405001008', '2405', '2405001', 'FIOLA DE 50 ML', 'FIOLA DE 50 ML', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'EUROLAB', NULL, NULL, 0, 2.0, NULL),
('2405001009', '2405', '2405001', 'FIOLA DE 500 ML', 'FIOLA DE 500 ML', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'EUROLAB', NULL, NULL, 0, 2.0, NULL),
('2405001010', '2405', '2405001', 'FRASCO VIDRIO ÁMBAR 250 ML', 'FRASCO VIDRIO ÁMBAR 250 ML', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 4.0, NULL),
('2405001011', '2405', '2405001', 'MATRAZ VIDRIO 250 ML', 'MATRAZ VIDRIO 250 ML', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 5.0, NULL),
('2405001012', '2405', '2405001', 'MATRAZ VIDRIO 500 ML', 'MATRAZ VIDRIO 500 ML', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 5.0, NULL),
('2405001013', '2405', '2405001', 'MORTERO CON PILÓN 80 MM', 'MORTERO CON PILÓN 80 MM', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 1.0, NULL),
('2405001014', '2405', '2405001', 'PAPEL FILTRO MAX WIPE', 'PAPEL FILTRO MAX WIPE', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 15.0, NULL),
('2405001015', '2405', '2405001', 'PICNOMETRO DE 100 ML', 'PICNOMETRO DE 100 ML', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 2.0, NULL),
('2405001016', '2405', '2405001', 'PICNOMETRO DE 50 ML', 'PICNOMETRO DE 50 ML', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 1.0, NULL),
('2405001017', '2405', '2405001', 'PINZAS MARIPOSA', 'PINZAS MARIPOSA', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 1.0, NULL),
('2405001018', '2405', '2405001', 'PIPETA SEROLOGICA VIDRIO 1 ML', 'PIPETA VIDRIO 1 ML', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 1.0, NULL),
('2405001019', '2405', '2405001', 'PIPETA SEROLOGICA VIDRIO 10 ML', 'PIPETA VIDRIO 10 ML', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 2.0, NULL),
('2405001020', '2405', '2405001', 'PIZETA PLÁSTICO 500 ML', 'PIZETA PLÁSTICO 500 ML', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 2.0, NULL),
('2405001021', '2405', '2405001', 'PROBETA VIDRIO 100 ML', 'PROBETA VIDRIO 100 ML', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 2.0, NULL),
('2405001022', '2405', '2405001', 'SOPORTE UNIVERSAL', 'SOPORTE UNIVERSAL', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 1.0, NULL),
('2405001023', '2405', '2405001', 'TABLA DE PICAR', 'TABLA DE PICAR', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 1.0, NULL),
('2405001024', '2405', '2405001', 'TUBOS DE ENSAYO', 'TUBOS DE ENSAYO', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 18.0, NULL),
('2405001025', '2405', '2405001', 'VASO PRECIPITACIÓN 100 ML', 'VASO PRECIPITACIÓN 100 ML', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 2.0, NULL),
('2405001026', '2405', '2405001', 'VASO PRECIPITACIÓN 1000 ML', 'VASO PRECIPITACIÓN 1000 ML', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 2.0, NULL),
('2405001027', '2405', '2405001', 'VASO PRECIPITACIÓN 250 ML', 'VASO PRECIPITACIÓN 250 ML', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 2.0, NULL),
('2405001028', '2405', '2405001', 'VASO PRECIPITACIÓN 500 ML', 'VASO PRECIPITACIÓN 500 ML', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 4.0, NULL),
('2405003001', '2405', '2405003', 'BOMBA TRASBASE SIFÓN', 'BOMBA TRASVASE SIFÓN', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 1.0, NULL),
('2405003002', '2405', '2405003', 'CABEZAL DE ESPARSORES', 'CABEZAL DE ESPARSORES', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 9.0, NULL),
('2405003003', '2405', '2405003', 'MALLA NYLON ORGANZA', 'MALLA NYLON ORGANZA', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 1.0, NULL),
('2405003004', '2405', '2405003', 'TELA FILTRO TOCUYO', 'TELA FILTRO TOCUYO', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 1.0, NULL),
('2405005001', '2405', '2405005', 'AGITADOR 2 MASAS', 'AGITADOR 2 MASAS', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 2.0, NULL),
('2405005002', '2405', '2405005', 'AGITADOR AUTOMÁTICO MOTOR', 'AGITADOR AUTOMÁTICO MOTOR', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'MYN', NULL, NULL, 0, 2.0, NULL),
('2405005003', '2405', '2405005', 'AGITADOR MANUAL', 'AGITADOR MANUAL', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'INACO', NULL, NULL, 0, 1.0, NULL),
('2405005004', '2405', '2405005', 'AGITADOR MANUAL', 'AGITADOR MANUAL', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'BANKER', NULL, NULL, 0, 2.0, NULL),
('2405005005', '2405', '2405005', 'AGITADOR MANUAL', 'AGITADOR MANUAL', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'CINHALL', NULL, NULL, 0, 1.0, NULL),
('2405005006', '2405', '2405005', 'ALICATES', 'ALICATES', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 2.0, NULL),
('2405005007', '2405', '2405005', 'BALANZA GRAMERA PLATAFORMA', 'BALANZA GRAMERA PLATAFORMA', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'MINEBEA', NULL, NULL, 0, 1.0, NULL),
('2405005008', '2405', '2405005', 'BALANZA SF-400', 'BALANZA SF-400', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'SM', 'SF-400', NULL, 0, 1.0, NULL),
('2405005009', '2405', '2405005', 'CANDADO DORADO 75 MM', 'CANDADO DORADO 75 MM', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'WINGS', '75 mm', NULL, 0, 2.0, NULL),
('2405005010', '2405', '2405005', 'COLADOR DOBLEMALLA', 'COLADOR DOBLEMALLA', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 4.0, NULL),
('2405005011', '2405', '2405005', 'DESTORNILLADORES VARIOS', 'DESTORNILLADORES VARIOS', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 11.0, NULL),
('2405005012', '2405', '2405005', 'EMBUDOS PLASTICOS', 'EMBUDOS PLASTICOS', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 5.0, NULL),
('2405005013', '2405', '2405005', 'EXTENSIÓN ELÉCTRICA 30 M', 'EXTENSIÓN ELÉCTRICA 30 M', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, '30 m', NULL, 0, 2.0, NULL),
('2405005014', '2405', '2405005', 'MEZCLADOR PORTÁTIL', 'MEZCLADOR PORTÁTIL', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 2.0, NULL),
('2405005015', '2405', '2405005', 'MOLINO DE DISCOS', 'MOLINO DE DISCOS', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'DAKOTA', NULL, NULL, 0, 1.0, NULL),
('2405005016', '2405', '2405005', 'MOLINO DE GRANO', 'MOLINO DE GRANO', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'HECHIZO', NULL, NULL, 0, 1.0, NULL),
('2405005017', '2405', '2405005', 'TALADRO PERCUTOR 550W', 'TALADRO PERCUTOR 550W', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'TRUPER', NULL, NULL, 0, 1.0, NULL),
('2405005018', '2405', '2405005', 'TALADRO PERCUTOR 550W', 'TALADRO PERCUTOR 550W', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'WERKEN', NULL, NULL, 0, 4.0, NULL),
('2405005019', '2405', '2405005', 'TERMÓMETRO DIGITAL (-50 A 300 °C)', 'TERMÓMETRO DIGITAL', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'TRACEABLE', NULL, NULL, 0, 1.0, NULL),
('2405006001', '2405', '2405006', 'CASCO DE SEGURIDAD', 'CASCO DE SEGURIDAD', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 7.0, NULL),
('2405006002', '2405', '2405006', 'GUANTES NITRILO NEGRO', 'GUANTES NITRILO NEGRO', NULL, NULL, NULL, NULL, NULL, NULL, 'BX', NULL, NULL, NULL, 0, 1.0, NULL),
('2405006003', '2405', '2405006', 'GUANTES NITRILO SC', 'GUANTES NITRILO NEGRO', NULL, NULL, NULL, NULL, NULL, NULL, 'BX', NULL, NULL, NULL, 0, 6.0, NULL),
('2405006004', '2405', '2405006', 'GUANTES NITRILO VERDE', 'GUANTES NITRILO VERDE', NULL, NULL, NULL, NULL, NULL, NULL, 'BX', NULL, NULL, NULL, 0, 5.0, NULL),
('2405006005', '2405', '2405006', 'LENTES DE SEGURIDAD', 'LENTES DE SEGURIDAD', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 5.0, NULL),
('2405006006', '2405', '2405006', 'MASCARILLAS', 'MASCARILLAS', NULL, NULL, NULL, NULL, NULL, NULL, 'BX', NULL, NULL, NULL, 0, 5.0, NULL),
('2405006007', '2405', '2405006', 'TOCAS', 'TOCAS', NULL, NULL, NULL, NULL, NULL, NULL, 'BX', NULL, NULL, NULL, 0, 4.0, NULL),
('2405007001', '2405', '2405007', 'BALDES LIMPIEZA', 'BALDES LIMPIEZA', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 9.0, NULL),
('2405007002', '2405', '2405007', 'DESINFECTANTE', 'DESINFECTANTE', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 1.0, NULL),
('2405007003', '2405', '2405007', 'ESCOBAS', 'ESCOBAS', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 2.0, NULL),
('2405007004', '2405', '2405007', 'TRAPEROS', 'TRAPEROS', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 2.0, NULL),
('2405008001', '2405', '2405008', 'ACEITE 3 EN 1', 'ACEITE 3 EN 1', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 2.0, NULL),
('2405010001', '2405', '2405010', 'ARCHIVADORES', 'ARCHIVADORES', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 6.0, NULL),
('2405010002', '2405', '2405010', 'CINTAS ADHESIVAS', 'CINTAS ADHESIVAS', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 2.0, NULL),
('2405010003', '2405', '2405010', 'CUADERNOS', 'CUADERNOS', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 11.0, NULL),
('2405010004', '2405', '2405010', 'GRAPADORAS', 'GRAPADORAS', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 5.0, NULL),
('2405010005', '2405', '2405010', 'LAPICEROS', 'LAPICEROS', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 15.0, NULL),
('2405010006', '2405', '2405010', 'PAJARRAN', 'PAJARRAN', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 1.0, NULL),
('2405010007', '2405', '2405010', 'PERFORADORAS', 'PERFORADORAS', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 2.0, NULL),
('2405010008', '2405', '2405010', 'REGLAS', 'REGLAS', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 3.0, NULL),
('2405010009', '2405', '2405010', 'TIJERAS', 'TIJERAS', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 6.0, NULL),
('2405011001', '2405', '2405011', 'BIDON DE AGUA', 'BIDON DE AGUA', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 717.0, NULL),
('2405011002', '2405', '2405011', 'DUCHA DE EMERGENCIA', 'DUCHA DE EMERGENCIA', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 1.0, NULL),
('2405011003', '2405', '2405011', 'EXTINTOR CO₂ 5 KG', 'EXTINTOR CO₂ 9 KG', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, '5 kg', NULL, 0, 1.0, NULL),
('2405011004', '2405', '2405011', 'EXTINTOR PQS 6 KG', 'EXTINTOR PQS 6 KG', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, '6 kg', NULL, 0, 2.0, NULL),
('2405011005', '2405', '2405011', 'ILUMINARIA LED INDUSTRIAL', 'ILUMINARIA LED INDUSTRIAL', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 2.0, NULL),
('2405011006', '2405', '2405011', 'MASETEROS', 'MASETEROS', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 10.0, NULL),
('2405011007', '2405', '2405011', 'STRECHFILM', 'STRECHFILM', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 0, 3.0, NULL),
('3306001001', '3306', '3306001', 'ELECTROBOMBA PERIFÉRICA', 'ELECTROBOMBA PERIFÉRICA', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'PEDROLLO', NULL, NULL, 1, 2.0, NULL),
('3306001002', '3306', '3306001', 'HIDROLAVADORA', 'HIDROLAVADORA', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'BAUKER', NULL, NULL, 1, 1.0, NULL),
('3306002001', '3306', '3306002', 'AGITADOR MAGNÉTICO', 'AGITADOR MAGNÉTICO', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'INTLLAB', NULL, NULL, 1, 1.0, NULL),
('3306002002', '3306', '3306002', 'AGITADOR MAGNÉTICO', 'AGITADOR MAGNÉTICO', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'DLAB', 'MS-H280-PRO', NULL, 1, 1.0, NULL),
('3306002003', '3306', '3306002', 'BALANZA 150 KG', 'BALANZA 150 KG', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'PRICE SCALE', NULL, NULL, 1, 2.0, NULL),
('3306002004', '3306', '3306002', 'BALANZA 30 KG', 'BALANZA 30 KG', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', '"PATRICK''S"', NULL, NULL, 1, 1.0, NULL),
('3306002005', '3306', '3306002', 'BALANZA 300 KG', 'BALANZA 300 KG', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', '"PATRICK''S"', NULL, NULL, 1, 1.0, NULL),
('3306002006', '3306', '3306002', 'BALANZA 40 KG', 'BALANZA 40 KG', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'ELECTRONIC PRICE', NULL, NULL, 1, 1.0, NULL),
('3306002007', '3306', '3306002', 'BALANZA 400 KG CON RUEDAS', 'BALANZA 400 KG CON RUEDAS', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'RAY SCALE', NULL, NULL, 1, 1.0, NULL),
('3306002008', '3306', '3306002', 'BALANZA ANALÍTICA (220 GR A 1GR)', 'BALANZA ANALÍTICA', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'SARTORIUS', 'ENTRIS', NULL, 1, 1.0, NULL),
('3306002009', '3306', '3306002', 'BALANZA DIGITAL 30 KG', 'BALANZA DIGITAL 30 KG', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, '30 kg', NULL, 1, 1.0, NULL),
('3306002010', '3306', '3306002', 'CONDUCTÍMETRO', 'CONDUCTÍMETRO', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 1, 1.0, NULL),
('3306002011', '3306', '3306002', 'HORNO ESTUFA ESTERILIZADOR', 'HORNO ESTUFA ESTERILIZADOR', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'FAITHFUL', 'GX-65BE', NULL, 1, 1.0, NULL),
('3306002012', '3306', '3306002', 'MEDIDOR MULTIPARÁMETRO PH', 'MEDIDOR MULTIPARÁMETRO PH', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'SUNTEX', NULL, NULL, 1, 1.0, NULL),
('3306002013', '3306', '3306002', 'PLANCHA CALEFACTORA', 'PLANCHA CALEFACTORA', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 1, 1.0, NULL),
('3306002014', '3306', '3306002', 'REFRACTÓMETRO DIGITAL PORTÁTIL', 'REFRACTÓMETRO DIGITAL PORTÁTIL', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'ATAGO', 'PAL-A', NULL, 1, 1.0, NULL),
('3306002015', '3306', '3306002', 'SELLADORA DE BOLSAS', 'SELLADORA DE BOLSAS', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'KENBRO/BOXA', NULL, NULL, 1, 1.0, NULL),
('3306005001', '3306', '3306005', 'CONGELADOR', 'CONGELADOR', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'ELECTROLUZ', NULL, NULL, 1, 1.0, NULL),
('3306005002', '3306', '3306005', 'ESTANTES DE MADERA', 'ESTANTES DE MADERA', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 1, 2.0, NULL),
('3306005003', '3306', '3306005', 'ESTANTES DE METAL', 'ESTANTES DE METAL', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 1, 8.0, NULL),
('3306005004', '3306', '3306005', 'LOCKER METALICO 6 PUERTAS', 'LOCKER METALICO 6 PUERTAS', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 1, 1.0, NULL),
('3306005005', '3306', '3306005', 'MESA ACERO INOXIDABLE 1.3*90CM', 'MESA ACERO INOXIDABLE 1.3*90CM', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 1, 2.0, NULL),
('3306005006', '3306', '3306005', 'MESA ACERO INOXIDABLE 1.8*60CM', 'MESA ACERO INOXIDABLE 1.8*60CM', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 1, 1.0, NULL),
('3306005007', '3306', '3306005', 'MICROONDAS', 'MICROONDAS', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'BLACKLINE', NULL, NULL, 1, 1.0, NULL),
('3306005008', '3306', '3306005', 'REFRIGERADORA', 'REFRIGERADORA', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'LG', NULL, NULL, 1, 1.0, NULL),
('3306005009', '3306', '3306005', 'SILLAS METALICAS NEGRAS', 'SILLAS METALICAS NEGRAS', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', NULL, NULL, NULL, 1, 4.0, NULL),
('3306005010', '3306', '3306005', 'SILLAS PLASTICAS BLANCAS', 'SILLAS PLASTICAS BLANCAS REY', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'REY', NULL, NULL, 1, 10.0, NULL),
('3306005011', '3306', '3306005', 'SILLON IBIZA', 'SILLON IBIZA DURAPLAST', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'DURAPLAST', NULL, NULL, 1, 3.0, NULL),
('3306005012', '3306', '3306005', 'VENTILADOR', 'VENTILADOR', NULL, NULL, NULL, NULL, NULL, NULL, 'NIU', 'WURDEN', NULL, NULL, 1, 1.0, NULL);

-- =============================================
-- 3. DISTRIBUCIÓN DE DATOS A TABLAS REALES
-- =============================================

-- A. Insertar Marcas y Modelos Nuevos detectados en la carga
INSERT INTO marca (nombre, estado) 
SELECT DISTINCT marca, 1 FROM #TempLoad WHERE marca IS NOT NULL AND NOT EXISTS (SELECT 1 FROM marca WHERE nombre = marca);

INSERT INTO modelo (nombre, estado, marca_id)
SELECT DISTINCT modelo, 1, NULL FROM #TempLoad WHERE modelo IS NOT NULL AND NOT EXISTS (SELECT 1 FROM modelo WHERE nombre = modelo);

-- B. Insertar PRODUCTOS
INSERT INTO producto (
    codigo, grupo_id, cod_grupo, descripcion_grupo, subgrupo_id, cod_subgrupo, descripcion_subgrupo, 
    descripcion_producto, descripcion_comercial, concentracion, cod_formulacion_quimica, lote, 
    fecha_fabricacion, fecha_vencimiento, cod_peligrosidad, cod_unidad_medida, marca_id, modelo_id, 
    serie, es_activo_fijo, estado, empresa_id
)
SELECT 
    t.p_code, g.id, t.g_code, g.descripcion,
    s.id, t.s_code, s.descripcion,
    t.desc_prod, t.desc_com, t.conc,
    t.form, t.lote, t.f_fab, t.f_ven,
    t.peligro, t.um, m.id, mo.id,
    t.serie, t.activo, 1, 1
FROM #TempLoad t
LEFT JOIN grupo g ON g.codigo = t.g_code
LEFT JOIN subgrupo s ON s.codigo = t.s_code
LEFT JOIN marca m ON m.nombre = t.marca
LEFT JOIN modelo mo ON mo.nombre = t.modelo
WHERE NOT EXISTS (SELECT 1 FROM producto p WHERE p.codigo = t.p_code);

-- C. Insertar STOCK INICIAL (Almacén 01)
INSERT INTO stock_almacen (almacen_id, cod_producto, stock_actual)
SELECT 
    (SELECT TOP 1 id FROM almacen WHERE codigo = '01'), t.p_code, t.qty
FROM #TempLoad t
WHERE NOT EXISTS (SELECT 1 FROM stock_almacen sa WHERE sa.cod_producto = t.p_code AND sa.almacen_id = (SELECT TOP 1 id FROM almacen WHERE codigo = '01'));

-- D. Insertar DETALLE INGREDIENTES
INSERT INTO detalle_ingrediente_activo (cod_producto, ingrediente_activo_id, porcentaje)
SELECT t.p_code, i.id, ISNULL(t.conc, 0)
FROM #TempLoad t
JOIN ingrediente_activo i ON i.descripcion = t.ingrediente
WHERE t.ingrediente IS NOT NULL
AND NOT EXISTS (SELECT 1 FROM detalle_ingrediente_activo d WHERE d.cod_producto = t.p_code);

DROP TABLE #TempLoad;

GO

DECLARE @IdIngreso INT;
DECLARE @Fecha DATE = GETDATE();

-- 1. INSERTAR LA CABECERA (Un solo registro que agrupa todo)
INSERT INTO ingresosalidaalm (
    fecha, 
    numero, 
    sucursal_id, 
    almacen_id, 
    tipo_movimiento, -- 1: Entrada
    motivo_id,       -- 7: Según tu indicación (Nota: Verifica si es 7 o 16 "Saldo Inicial")
    moneda_id,       -- 1: Soles
    estado_id,       -- 1: Aprobado
    usuario_id       -- NULL
) 
VALUES (
    @Fecha, 
    '0000000001',   -- Número generado manualmente para el saldo inicial
    1,               -- Sucursal 1
    1,               -- Almacén 1
    1,               -- Tipo Movimiento: Entrada
    7,               -- Motivo ID (Lo puse fijo como pediste)
    1,               -- Moneda Soles
    1,               -- Estado Activo
    NULL
);

-- Capturamos el ID que se acaba de crear
SET @IdIngreso = SCOPE_IDENTITY();

-- 2. INSERTAR LOS DETALLES (Masivamente desde stock_almacen)
INSERT INTO dingresosalidaalm (
    ingresosalidaalm_id,
    item,
    cod_producto,
    descripcion_producto,
    cod_unidad_medida,
    cantidad,
    precio,
    igv,
    subtotal,
    total,
    moneda_id,
    tipo_cambio,
    fecha_registro
)
SELECT 
    @IdIngreso,                         -- El ID de la cabecera creada arriba
    ROW_NUMBER() OVER(ORDER BY sa.id),  -- Genera el item 1, 2, 3... automáticamente
    sa.cod_producto,
    p.descripcion_producto,             -- Obtenido de la tabla producto
    p.cod_unidad_medida,                -- Obtenido de la tabla producto
    sa.stock_actual,                    -- La cantidad viene del stock cargado
    0,                                  -- Precio 0
    0,                                  -- IGV 0
    0,                                  -- Subtotal 0
    0,                                  -- Total 0
    1,                                  -- Moneda ID
    1,                                  -- Tipo cambio
    GETDATE()
FROM stock_almacen sa
INNER JOIN producto p ON sa.cod_producto = p.codigo
WHERE sa.almacen_id = 1 AND sa.cod_producto NOT IN ('2102010003', '2102010004', '2102010005'); -- Aseguramos que solo migramos lo del almacén 1

PRINT 'Movimiento de Saldo Inicial generado correctamente con ID: ' + CAST(@IdIngreso AS VARCHAR);
PRINT 'Migracion Completada Exitosamente.'